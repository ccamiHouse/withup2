{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/ccami/project/%2B%2Bprd%20%E1%84%8B%E1%85%A7%E1%86%AB%E1%84%89%E1%85%B3%E1%86%B8/withup2/components/MapComponent.js"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\nimport { MapContainer, TileLayer, Marker, Popup, useMap } from \"react-leaflet\";\nimport L from \"leaflet\";\nimport \"leaflet/dist/leaflet.css\";\n\n// Fix for default marker icons in Next.js\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png\",\n  iconUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png\",\n  shadowUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png\",\n});\n\n// Custom icon\nconst customIcon = new L.Icon({\n  iconUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png\",\n  iconRetinaUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png\",\n  shadowUrl: \"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png\",\n  iconSize: [25, 41],\n  iconAnchor: [12, 41],\n  popupAnchor: [1, -34],\n  shadowSize: [41, 41],\n});\n\n// Component to handle map clicks\nfunction MapClickHandler({ onLocationSelect }) {\n  const map = useMap();\n\n  useEffect(() => {\n    const handleClick = async (e) => {\n      const { lat, lng } = e.latlng;\n      \n      // Reverse geocode to get address\n      try {\n        const response = await fetch(\n          `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18&addressdetails=1`,\n          {\n            headers: {\n              'User-Agent': 'WithUp Study App'\n            }\n          }\n        );\n        const data = await response.json();\n        const address = data.display_name || `${lat.toFixed(6)}, ${lng.toFixed(6)}`;\n        \n        onLocationSelect(lat, lng, address);\n      } catch (error) {\n        console.error(\"Geocoding error:\", error);\n        onLocationSelect(lat, lng, `${lat.toFixed(6)}, ${lng.toFixed(6)}`);\n      }\n    };\n\n    map.on(\"click\", handleClick);\n    map.doubleClickZoom.disable();\n\n    return () => {\n      map.off(\"click\", handleClick);\n      map.doubleClickZoom.enable();\n    };\n  }, [map, onLocationSelect]);\n\n  return null;\n}\n\n// Component to handle search\nfunction SearchHandler({ searchQuery }) {\n  const map = useMap();\n  const [isSearching, setIsSearching] = useState(false);\n\n  useEffect(() => {\n    if (!searchQuery || searchQuery.length < 2) return;\n\n    const searchLocation = async () => {\n      setIsSearching(true);\n      try {\n        const response = await fetch(\n          `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(searchQuery)}&limit=1&countrycodes=kr`,\n          {\n            headers: {\n              'User-Agent': 'WithUp Study App'\n            }\n          }\n        );\n        const data = await response.json();\n        \n        if (data.length > 0) {\n          const result = data[0];\n          const lat = parseFloat(result.lat);\n          const lon = parseFloat(result.lon);\n          \n          map.setView([lat, lon], 15);\n        }\n      } catch (error) {\n        console.error(\"Search error:\", error);\n      } finally {\n        setIsSearching(false);\n      }\n    };\n\n    // Debounce search\n    const timer = setTimeout(searchLocation, 500);\n    return () => clearTimeout(timer);\n  }, [searchQuery, map]);\n\n  return null;\n}\n\nexport default function MapComponent({ onLocationSelect, searchQuery = \"\" }) {\n  const [position, setPosition] = useState([37.5665, 126.9780]); // Default to Seoul\n  const [markerPosition, setMarkerPosition] = useState(null);\n\n  useEffect(() => {\n    // Get user's current location if available\n    if (\"geolocation\" in navigator) {\n      navigator.geolocation.getCurrentPosition(\n        (pos) => {\n          setPosition([pos.coords.latitude, pos.coords.longitude]);\n        },\n        () => {\n          console.log(\"Geolocation not available\");\n        }\n      );\n    }\n  }, []);\n\n  const handleMapClick = (lat, lng, address) => {\n    setMarkerPosition([lat, lng]);\n    if (onLocationSelect) {\n      onLocationSelect(lat, lng, address);\n    }\n  };\n\n  return (\n    <div className=\"relative w-full h-full\">\n      <MapContainer\n        center={position}\n        zoom={13}\n        style={{ height: \"100%\", width: \"100%\" }}\n      >\n        <TileLayer\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n        \n        <MapClickHandler onLocationSelect={handleMapClick} />\n        <SearchHandler searchQuery={searchQuery} />\n        \n        {markerPosition && (\n          <Marker position={markerPosition} icon={customIcon}>\n            <Popup>\n              선택한 위치\n              <br />\n              {markerPosition[0].toFixed(6)}, {markerPosition[1].toFixed(6)}\n            </Popup>\n          </Marker>\n        )}\n      </MapContainer>\n      \n      <div className=\"absolute bottom-4 left-4 bg-white px-3 py-2 rounded-lg shadow-lg z-1000 pointer-events-none\">\n        <p className=\"text-sm text-gray-600\">지도를 클릭하여 위치를 선택하세요</p>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}